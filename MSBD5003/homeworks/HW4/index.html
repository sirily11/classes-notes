
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.3">
    
    
      
        <title>Hw4 - Class Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.e35208c4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#import-dependencies" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Class Notes" class="md-header__button md-logo" aria-label="Class Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Class Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Hw4
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Class Notes" class="md-nav__button md-logo" aria-label="Class Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Class Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      <label class="md-nav__link" for="__nav_1">
        Msbd5003
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Msbd5003" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Msbd5003
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Algorithm/" class="md-nav__link">
        Algorithm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Azure%20Cloud/" class="md-nav__link">
        Azure cloud
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Big%20Data%20and%20HDFS/" class="md-nav__link">
        Big data and hdfs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../HBase/" class="md-nav__link">
        Hbase
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Lecture3/" class="md-nav__link">
        Lecture3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../MLib/" class="md-nav__link">
        Mlib
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Spark%20SQL/" class="md-nav__link">
        Spark sql
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Spark%20Streaming/" class="md-nav__link">
        Spark streaming
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Spark%20basics%20and%20RDD/" class="md-nav__link">
        Spark basics and rdd
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_11" type="checkbox" id="__nav_1_11" checked>
      
      <label class="md-nav__link" for="__nav_1_11">
        Homeworks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Homeworks" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_11">
          <span class="md-nav__icon md-icon"></span>
          Homeworks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Hw4
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Hw4
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#question-1" class="md-nav__link">
    Question 1
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hw1/" class="md-nav__link">
        Hw1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hw2/" class="md-nav__link">
        Hw2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hw3/" class="md-nav__link">
        Hw3
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_12" data-md-state="indeterminate" type="checkbox" id="__nav_1_12" checked>
      
      <label class="md-nav__link" for="__nav_1_12">
        Notebooks in class
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Notebooks in class" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_12">
          <span class="md-nav__icon md-icon"></span>
          Notebooks in class
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks%20in%20class/DC/" class="md-nav__link">
        Dc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks%20in%20class/PMI/" class="md-nav__link">
        Pmi
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks%20in%20class/graph/" class="md-nav__link">
        Graph
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks%20in%20class/internal/" class="md-nav__link">
        Internal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks%20in%20class/mllib/" class="md-nav__link">
        Mllib
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks%20in%20class/rdd/" class="md-nav__link">
        Rdd
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks%20in%20class/sparksql/" class="md-nav__link">
        Sparksql
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_13" data-md-state="indeterminate" type="checkbox" id="__nav_1_13" checked>
      
      <label class="md-nav__link" for="__nav_1_13">
        Projects
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Projects" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_13">
          <span class="md-nav__icon md-icon"></span>
          Projects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../projects/Project/" class="md-nav__link">
        Project
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Msbd5008
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Msbd5008" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Msbd5008
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5008/Lecture2/" class="md-nav__link">
        Lecture2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5008/Lecture3/" class="md-nav__link">
        Lecture3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5008/Lecture4/" class="md-nav__link">
        Lecture4
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5008/Lecture5/" class="md-nav__link">
        Lecture5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5008/Lectyre6/" class="md-nav__link">
        Lectyre6
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" data-md-state="indeterminate" type="checkbox" id="__nav_2_6" checked>
      
      <label class="md-nav__link" for="__nav_2_6">
        Homework
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Homework" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Homework
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5008/homework/homework1/" class="md-nav__link">
        Homework1
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Msbd5001
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Msbd5001" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Msbd5001
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/Lecture%202/" class="md-nav__link">
        Lecture 2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/Lecture%203/" class="md-nav__link">
        Lecture 3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/Lecture%209/" class="md-nav__link">
        Lecture 9
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/Lecture1/" class="md-nav__link">
        Lecture1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/Lecture4/" class="md-nav__link">
        Lecture4
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/Lecture6/" class="md-nav__link">
        Lecture6
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_7" data-md-state="indeterminate" type="checkbox" id="__nav_3_7" checked>
      
      <label class="md-nav__link" for="__nav_3_7">
        Project
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Project" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Project
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/project/Copy%20of%20Individual%20Project/" class="md-nav__link">
        Copy of individual project
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/project/Group%20Project/" class="md-nav__link">
        Group project
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/project/Individual%20Project/" class="md-nav__link">
        Individual project
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5001/project/msbd5001-fall2020/" class="md-nav__link">
        Msbd5001-fall2020
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Msbd5012
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Msbd5012" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Msbd5012
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" data-md-state="indeterminate" type="checkbox" id="__nav_4_1" checked>
      
      <label class="md-nav__link" for="__nav_4_1">
        Project
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Project" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Project
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5012/project/LSTM/" class="md-nav__link">
        Lstm
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" data-md-state="indeterminate" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Msbd5006
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Msbd5006" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Msbd5006
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5006/Lecture%201/" class="md-nav__link">
        Lecture 1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../MSBD5006/Lecture%202/" class="md-nav__link">
        Lecture 2
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#question-1" class="md-nav__link">
    Question 1
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <div class="codehilite"><pre><span></span><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">networkx</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>Requirement already satisfied: networkx in /opt/conda/lib/python3.8/site-packages (2.5)
Requirement already satisfied: decorator&gt;=4.3.0 in /opt/conda/lib/python3.8/site-packages (from networkx) (4.4.2)
</code></pre></div>
<h1 id="import-dependencies">Import dependencies<a class="headerlink" href="#import-dependencies" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYSPARK_SUBMIT_ARGS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;--packages graphframes:graphframes:0.8.1-spark3.0-s_2.12 pyspark-shell&#39;</span>

<span class="kn">from</span> <span class="nn">pyspark.context</span> <span class="kn">import</span> <span class="n">SparkContext</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.session</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="kn">from</span> <span class="nn">graphframes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">PlotGraph</span><span class="p">(</span><span class="n">edge_list</span><span class="p">):</span>
    <span class="n">Gplot</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span><span class="s1">&#39;dst&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">Gplot</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;dst&#39;</span><span class="p">])</span>

<span class="c1">#     plt.subplot(121)</span>
<span class="c1">#     plt.figure(figsize=(10, 10))</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">Gplot</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">v</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
  <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;Esther&quot;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;Fanny&quot;</span><span class="p">,</span> <span class="mi">38</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;Gabby&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="p">],</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">])</span>

<span class="c1"># Edges DataFrame</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">([</span>
  <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;friend&quot;</span><span class="p">),</span>
  <span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;follow&quot;</span><span class="p">)</span>
<span class="p">],</span> <span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">,</span> <span class="s2">&quot;relationship&quot;</span><span class="p">])</span>

<span class="c1"># Create a GraphFrame</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">GraphFrame</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>+---+-------+---+
| id|   name|age|
+---+-------+---+
|  a|  Alice| 34|
|  b|    Bob| 36|
|  c|Charlie| 37|
|  d|  David| 29|
|  e| Esther| 32|
|  f|  Fanny| 38|
|  g|  Gabby| 60|
+---+-------+---+

+---+---+------------+
|src|dst|relationship|
+---+---+------------+
|  a|  b|      friend|
|  b|  c|      follow|
|  c|  b|      follow|
|  f|  c|      follow|
|  e|  f|      follow|
|  e|  d|      friend|
|  d|  a|      friend|
|  a|  e|      friend|
|  g|  e|      follow|
+---+---+------------+
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">PlotGraph</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</code></pre></div>

<p><img alt="png" src="data:image/png;base64,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" /></p>
<h2 id="question-1">Question 1<a class="headerlink" href="#question-1" title="Permanent link">&para;</a></h2>
<p>Write code to perform the following tasks using GraphFrames:</p>
<p>Find Alice's two-hop neighbors' names, regardless of the edge type.</p>
<div class="codehilite"><pre><span></span><code><span class="n">friends</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(a)-[]-&gt;(b);(b)-[]-&gt;(c)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;a.name=&#39;Alice&#39;&quot;</span><span class="p">)</span>
<span class="n">friends</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>[Row(c=Row(id=&#39;f&#39;, name=&#39;Fanny&#39;, age=38)),
 Row(c=Row(id=&#39;d&#39;, name=&#39;David&#39;, age=29)),
 Row(c=Row(id=&#39;c&#39;, name=&#39;Charlie&#39;, age=37))]
</code></pre></div>
<h1 id="question-2">Question 2<a class="headerlink" href="#question-2" title="Permanent link">&para;</a></h1>
<p>Redo the previous question, but exclude Alice's two-hop neighbors who have an edge back to Alice.</p>
<div class="codehilite"><pre><span></span><code><span class="n">friends</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(a)-[]-&gt;(b);(b)-[]-&gt;(c);(c)-[]-&gt;(a)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;a.name=&#39;Alice&#39;&quot;</span><span class="p">)</span>
<span class="n">friends</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>[Row(c=Row(id=&#39;d&#39;, name=&#39;David&#39;, age=29))]
</code></pre></div>
<h1 id="question-3">Question 3<a class="headerlink" href="#question-3" title="Permanent link">&para;</a></h1>
<p>Find all people who follow Charlie.</p>
<p>Hint: Use AND in SQL, or (..) &amp; (..) in DataFrame boolean expressions.</p>
<div class="codehilite"><pre><span></span><code><span class="n">followers</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(a)-[e]-&gt;(b)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;b.name=&#39;Charlie&#39; AND e.relationship=&#39;follow&#39; &quot;</span><span class="p">)</span>
<span class="n">followers</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>+--------------+
|             a|
+--------------+
|[f, Fanny, 38]|
|  [b, Bob, 36]|
+--------------+
</code></pre></div>
<h1 id="question-4">Question 4<a class="headerlink" href="#question-4" title="Permanent link">&para;</a></h1>
<p>Find all people who are being followed by at least 2 people.</p>
<div class="codehilite"><pre><span></span><code><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">relationship</span> <span class="o">==</span> <span class="s1">&#39;follow&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;dst&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;count&gt;=2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>+---+-----+
|dst|count|
+---+-----+
|  c|    2|
+---+-----+
</code></pre></div>
<h1 id="question-5">Question 5<a class="headerlink" href="#question-5" title="Permanent link">&para;</a></h1>
<p>Create a queue of 10 RDDs using this data set and feed it into a Spark Streaming program.  Your Spark Streaming algorithm should maintain a state that keeps track of the longest noun seen so far associated with each distinct adjective. After each RDD, print any 5 adjectives and their associated longest nouns, as well as the longest noun associated with the adjective 'good'. Note that not every line in the data set contains exactly two words, so make sure to clean the data as they are fed into the streaming program.  The skeleton code is provided below:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyspark.streaming</span> <span class="kn">import</span> <span class="n">StreamingContext</span>

<span class="n">ssc</span> <span class="o">=</span> <span class="n">StreamingContext</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1"># Provide a checkpointing directory. Required for stateful transformations</span>
<span class="n">ssc</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">(</span><span class="s2">&quot;checkpoint&quot;</span><span class="p">)</span>

<span class="n">numPartitions</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s1">&#39;../data/adj_noun_pairs.txt&#39;</span><span class="p">,</span> <span class="n">numPartitions</span><span class="p">)</span>
<span class="n">rddQueue</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">randomSplit</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">ssc</span><span class="o">.</span><span class="n">queueStream</span><span class="p">(</span><span class="n">rddQueue</span><span class="p">)</span>

<span class="c1"># FILL IN YOUR CODE</span>

<span class="n">ssc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">ssc</span><span class="o">.</span><span class="n">awaitTermination</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ssc</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyspark.streaming</span> <span class="kn">import</span> <span class="n">StreamingContext</span>

<span class="n">ssc</span> <span class="o">=</span> <span class="n">StreamingContext</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1"># Provide a checkpointing directory. Required for stateful transformations</span>
<span class="n">ssc</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">(</span><span class="s2">&quot;checkpoint&quot;</span><span class="p">)</span>

<span class="n">numPartitions</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">rdd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s1">&#39;adj_noun_pairs.txt&#39;</span><span class="p">,</span> <span class="n">numPartitions</span><span class="p">)</span>
<span class="n">rddQueue</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">randomSplit</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">ssc</span><span class="o">.</span><span class="n">queueStream</span><span class="p">(</span><span class="n">rddQueue</span><span class="p">)</span>



<span class="n">ssc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">ssc</span><span class="o">.</span><span class="n">awaitTermination</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ssc</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>---------------------------------------------------------------------------

IllegalArgumentException                  Traceback (most recent call last)

&lt;ipython-input-49-043ad3d9c502&gt; in &lt;module&gt;
     12 
     13 
---&gt; 14 ssc.start()
     15 ssc.awaitTermination(10)
     16 ssc.stop(False)


/usr/local/spark/python/pyspark/streaming/context.py in start(self)
    177         Start the execution of the streams.
    178         &quot;&quot;&quot;
--&gt; 179         self._jssc.start()
    180         StreamingContext._activeContext = self
    181


/usr/local/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py in __call__(self, *args)
   1302 
   1303         answer = self.gateway_client.send_command(command)
-&gt; 1304         return_value = get_return_value(
   1305             answer, self.gateway_client, self.target_id, self.name)
   1306


/usr/local/spark/python/pyspark/sql/utils.py in deco(*a, **kw)
    132                 # Hide where the exception came from that shows a non-Pythonic
    133                 # JVM exception message.
--&gt; 134                 raise_from(converted)
    135             else:
    136                 raise


/usr/local/spark/python/pyspark/sql/utils.py in raise_from(e)


IllegalArgumentException: requirement failed: No output operations registered, so nothing to execute
</code></pre></div>
<div class="codehilite"><pre><span></span><code>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../../internal/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Internal
            </div>
          </div>
        </a>
      
      
        <a href="../hw1/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Hw1
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["instant", "navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../js/expand.js"></script>
      
    
  </body>
</html>