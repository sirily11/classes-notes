
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.6">
    
    
      
        <title>Project - Class Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6910b76c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.196e0c26.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#install-dependencies" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Class Notes" class="md-header-nav__button md-logo" aria-label="Class Notes">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Class Notes
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Project
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Class Notes" class="md-nav__button md-logo" aria-label="Class Notes">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Class Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
    <label class="md-nav__link" for="nav-1">
      Msbd5001
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Msbd5001" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Msbd5001
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/Lecture%202/" class="md-nav__link">
      Lecture 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/Lecture%203/" class="md-nav__link">
      Lecture 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/Lecture%209/" class="md-nav__link">
      Lecture 9
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/Lecture1/" class="md-nav__link">
      Lecture1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/Lecture4/" class="md-nav__link">
      Lecture4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/Lecture6/" class="md-nav__link">
      Lecture6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-7" type="checkbox" id="nav-1-7" >
    <label class="md-nav__link" for="nav-1-7">
      Project
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Project" data-md-level="2">
      <label class="md-nav__title" for="nav-1-7">
        <span class="md-nav__icon md-icon"></span>
        Project
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/project/Group%20Project/" class="md-nav__link">
      Group project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/project/Individual%20Project/" class="md-nav__link">
      Individual project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5001/project/LSTM/" class="md-nav__link">
      Lstm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    <label class="md-nav__link" for="nav-2">
      Msbd5006
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Msbd5006" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Msbd5006
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5006/Lecture%201/" class="md-nav__link">
      Lecture 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5006/Lecture%202/" class="md-nav__link">
      Lecture 2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    <label class="md-nav__link" for="nav-3">
      Msbd5008
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Msbd5008" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Msbd5008
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5008/Lecture2/" class="md-nav__link">
      Lecture2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5008/Lecture3/" class="md-nav__link">
      Lecture3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5008/Lecture4/" class="md-nav__link">
      Lecture4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5008/Lecture5/" class="md-nav__link">
      Lecture5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5008/Lectyre6/" class="md-nav__link">
      Lectyre6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6" >
    <label class="md-nav__link" for="nav-3-6">
      Homework
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Homework" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        <span class="md-nav__icon md-icon"></span>
        Homework
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5008/homework/homework1/" class="md-nav__link">
      Homework1
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Msbd5012
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Msbd5012" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Msbd5012
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1" >
    <label class="md-nav__link" for="nav-4-1">
      Lectures
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Lectures" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        <span class="md-nav__icon md-icon"></span>
        Lectures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5012/lectures/Lecture%202/" class="md-nav__link">
      Lecture 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5012/lectures/Lecture1/" class="md-nav__link">
      Lecture1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5012/lectures/Lecture3/" class="md-nav__link">
      Lecture3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5012/lectures/Lecture4/" class="md-nav__link">
      Lecture4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../MSBD5012/lectures/Lecture8/" class="md-nav__link">
      Lecture8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    <label class="md-nav__link" for="nav-5">
      Msbd5003
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Msbd5003" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Msbd5003
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Lecture1/" class="md-nav__link">
      Lecture1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Lecture2/" class="md-nav__link">
      Lecture2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Lecture3/" class="md-nav__link">
      Lecture3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Lecture4/" class="md-nav__link">
      Lecture4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Lecture5/" class="md-nav__link">
      Lecture5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Lecture6/" class="md-nav__link">
      Lecture6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Lecture7/" class="md-nav__link">
      Lecture7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Lecture8/" class="md-nav__link">
      Lecture8
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-9" type="checkbox" id="nav-5-9" >
    <label class="md-nav__link" for="nav-5-9">
      Homeworks
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Homeworks" data-md-level="2">
      <label class="md-nav__title" for="nav-5-9">
        <span class="md-nav__icon md-icon"></span>
        Homeworks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../homeworks/HW4/" class="md-nav__link">
      Hw4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../homeworks/hw1/" class="md-nav__link">
      Hw1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../homeworks/hw2/" class="md-nav__link">
      Hw2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../homeworks/hw3/" class="md-nav__link">
      Hw3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-10" type="checkbox" id="nav-5-10" >
    <label class="md-nav__link" for="nav-5-10">
      Notebooks in class
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Notebooks in class" data-md-level="2">
      <label class="md-nav__title" for="nav-5-10">
        <span class="md-nav__icon md-icon"></span>
        Notebooks in class
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks%20in%20class/DC/" class="md-nav__link">
      Dc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks%20in%20class/PMI/" class="md-nav__link">
      Pmi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks%20in%20class/graph/" class="md-nav__link">
      Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks%20in%20class/internal/" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks%20in%20class/rdd/" class="md-nav__link">
      Rdd
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks%20in%20class/sparksql/" class="md-nav__link">
      Sparksql
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-11" type="checkbox" id="nav-5-11" checked>
    <label class="md-nav__link" for="nav-5-11">
      Projects
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Projects" data-md-level="2">
      <label class="md-nav__title" for="nav-5-11">
        <span class="md-nav__icon md-icon"></span>
        Projects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Project
    </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="install-dependencies">Install dependencies<a class="headerlink" href="#install-dependencies" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="sx">!pip install googletrans</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>Collecting googletrans
  Downloading https://files.pythonhosted.org/packages/71/3a/3b19effdd4c03958b90f40fe01c93de6d5280e03843cc5adf6956bfc9512/googletrans-3.0.0.tar.gz
Collecting httpx==0.13.3
[?25l  Downloading https://files.pythonhosted.org/packages/54/b4/698b284c6aed4d7c2b4fe3ba5df1fcf6093612423797e76fbb24890dd22f/httpx-0.13.3-py3-none-any.whl (55kB)
[K     |████████████████████████████████| 61kB 3.2MB/s 
[?25hCollecting rfc3986&lt;2,&gt;=1.3
  Downloading https://files.pythonhosted.org/packages/78/be/7b8b99fd74ff5684225f50dd0e865393d2265656ef3b4ba9eaaaffe622b8/rfc3986-1.4.0-py2.py3-none-any.whl
Collecting httpcore==0.9.*
[?25l  Downloading https://files.pythonhosted.org/packages/dd/d5/e4ff9318693ac6101a2095e580908b591838c6f33df8d3ee8dd953ba96a8/httpcore-0.9.1-py3-none-any.whl (42kB)
[K     |████████████████████████████████| 51kB 4.3MB/s 
[?25hRequirement already satisfied: certifi in /usr/local/lib/python3.6/dist-packages (from httpx==0.13.3-&gt;googletrans) (2020.11.8)
Requirement already satisfied: idna==2.* in /usr/local/lib/python3.6/dist-packages (from httpx==0.13.3-&gt;googletrans) (2.10)
Collecting hstspreload
[?25l  Downloading https://files.pythonhosted.org/packages/d3/3c/cdeaf9ab0404853e77c45d9e8021d0d2c01f70a1bb26e460090926fe2a5e/hstspreload-2020.11.21-py3-none-any.whl (981kB)
[K     |████████████████████████████████| 983kB 6.4MB/s 
[?25hRequirement already satisfied: chardet==3.* in /usr/local/lib/python3.6/dist-packages (from httpx==0.13.3-&gt;googletrans) (3.0.4)
Collecting sniffio
  Downloading https://files.pythonhosted.org/packages/52/b0/7b2e028b63d092804b6794595871f936aafa5e9322dcaaad50ebf67445b3/sniffio-1.2.0-py3-none-any.whl
Collecting h11&lt;0.10,&gt;=0.8
[?25l  Downloading https://files.pythonhosted.org/packages/5a/fd/3dad730b0f95e78aeeb742f96fa7bbecbdd56a58e405d3da440d5bfb90c6/h11-0.9.0-py2.py3-none-any.whl (53kB)
[K     |████████████████████████████████| 61kB 7.0MB/s 
[?25hCollecting h2==3.*
[?25l  Downloading https://files.pythonhosted.org/packages/25/de/da019bcc539eeab02f6d45836f23858ac467f584bfec7a526ef200242afe/h2-3.2.0-py2.py3-none-any.whl (65kB)
[K     |████████████████████████████████| 71kB 6.7MB/s 
[?25hCollecting contextvars&gt;=2.1; python_version &lt; &quot;3.7&quot;
  Downloading https://files.pythonhosted.org/packages/83/96/55b82d9f13763be9d672622e1b8106c85acb83edd7cc2fa5bc67cd9877e9/contextvars-2.4.tar.gz
Collecting hyperframe&lt;6,&gt;=5.2.0
  Downloading https://files.pythonhosted.org/packages/19/0c/bf88182bcb5dce3094e2f3e4fe20db28a9928cb7bd5b08024030e4b140db/hyperframe-5.2.0-py2.py3-none-any.whl
Collecting hpack&lt;4,&gt;=3.0
  Downloading https://files.pythonhosted.org/packages/8a/cc/e53517f4a1e13f74776ca93271caef378dadec14d71c61c949d759d3db69/hpack-3.0.0-py2.py3-none-any.whl
Collecting immutables&gt;=0.9
[?25l  Downloading https://files.pythonhosted.org/packages/99/e0/ea6fd4697120327d26773b5a84853f897a68e33d3f9376b00a8ff96e4f63/immutables-0.14-cp36-cp36m-manylinux1_x86_64.whl (98kB)
[K     |████████████████████████████████| 102kB 7.1MB/s 
[?25hBuilding wheels for collected packages: googletrans, contextvars
  Building wheel for googletrans (setup.py) ... [?25l[?25hdone
  Created wheel for googletrans: filename=googletrans-3.0.0-cp36-none-any.whl size=15736 sha256=41d6607e625fb84483fb92ce5870ff80dce825ee8cdee5d005a6f66ac2b4f9a6
  Stored in directory: /root/.cache/pip/wheels/28/1a/a7/eaf4d7a3417a0c65796c547cff4deb6d79c7d14c2abd29273e
  Building wheel for contextvars (setup.py) ... [?25l[?25hdone
  Created wheel for contextvars: filename=contextvars-2.4-cp36-none-any.whl size=7666 sha256=bac0c5e9bd7288c7b7f764befbcfe3747b54567305e833c1eaceb02301a456d8
  Stored in directory: /root/.cache/pip/wheels/a5/7d/68/1ebae2668bda2228686e3c1cf16f2c2384cea6e9334ad5f6de
Successfully built googletrans contextvars
Installing collected packages: rfc3986, h11, hyperframe, hpack, h2, immutables, contextvars, sniffio, httpcore, hstspreload, httpx, googletrans
Successfully installed contextvars-2.4 googletrans-3.0.0 h11-0.9.0 h2-3.2.0 hpack-3.0.0 hstspreload-2020.11.21 httpcore-0.9.1 httpx-0.13.3 hyperframe-5.2.0 immutables-0.14 rfc3986-1.4.0 sniffio-1.2.0
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="sx">!pip install jieba</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>Requirement already satisfied: jieba in /usr/local/lib/python3.6/dist-packages (0.42.1)
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="sx">!pip install snownlp</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>Collecting snownlp
[?25l  Downloading https://files.pythonhosted.org/packages/3d/b3/37567686662100d3bce62d3b0f2adec18ab4b9ff2b61abd7a61c39343c1d/snownlp-0.12.3.tar.gz (37.6MB)
[K     |████████████████████████████████| 37.6MB 1.2MB/s 
[?25hBuilding wheels for collected packages: snownlp
  Building wheel for snownlp (setup.py) ... [?25l[?25hdone
  Created wheel for snownlp: filename=snownlp-0.12.3-cp36-none-any.whl size=37760959 sha256=a9e56804b51b20b5955ed305562310e2cffd780244fcb895b08cbbef094e126c
  Stored in directory: /root/.cache/pip/wheels/f3/81/25/7c197493bd7daf177016f1a951c5c3a53b1c7e9339fd11ec8f
Successfully built snownlp
Installing collected packages: snownlp
Successfully installed snownlp-0.12.3
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="sx">!pip install pyspark</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>Collecting pyspark
[?25l  Downloading https://files.pythonhosted.org/packages/f0/26/198fc8c0b98580f617cb03cb298c6056587b8f0447e20fa40c5b634ced77/pyspark-3.0.1.tar.gz (204.2MB)
[K     |████████████████████████████████| 204.2MB 39kB/s 
[?25hCollecting py4j==0.10.9
[?25l  Downloading https://files.pythonhosted.org/packages/9e/b6/6a4fb90cd235dc8e265a6a2067f2a2c99f0d91787f06aca4bcf7c23f3f80/py4j-0.10.9-py2.py3-none-any.whl (198kB)
[K     |████████████████████████████████| 204kB 50.5MB/s 
[?25hBuilding wheels for collected packages: pyspark
  Building wheel for pyspark (setup.py) ... [?25l[?25hdone
  Created wheel for pyspark: filename=pyspark-3.0.1-py2.py3-none-any.whl size=204612243 sha256=ff2703910c5d2146d9e5eb2fe81cfb913b4ef6e0f9485fbd4a600fe77ed82946
  Stored in directory: /root/.cache/pip/wheels/5e/bd/07/031766ca628adec8435bb40f0bd83bb676ce65ff4007f8e73f
Successfully built pyspark
Installing collected packages: py4j, pyspark
Successfully installed py4j-0.10.9 pyspark-3.0.1
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyspark.context</span> <span class="kn">import</span> <span class="n">SparkContext</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.session</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="n">Row</span>
<span class="c1"># NLP Module</span>
<span class="kn">from</span> <span class="nn">snownlp</span> <span class="kn">import</span> <span class="n">SnowNLP</span>
<span class="kn">import</span> <span class="nn">jieba</span>
<span class="c1"># translation</span>
<span class="kn">from</span> <span class="nn">googletrans</span> <span class="kn">import</span> <span class="n">Translator</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">urllib.request</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">file_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/sirily11/hot-keywords/releases/download/master/Sina_keyword.csv&quot;</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;Sina_keyword.csv&quot;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">file_url</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>(&#39;Sina_keyword.csv&#39;, &lt;http.client.HTTPMessage at 0x7f58c7be1b38&gt;)
</code></pre></div>
<h1 id="read-csv-file">Read csv file<a class="headerlink" href="#read-csv-file" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="n">StructType</span><span class="p">,</span> <span class="n">StructField</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">,</span> <span class="n">StringType</span><span class="p">,</span> <span class="n">TimestampType</span>

<span class="n">schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span>
                     <span class="n">StructField</span><span class="p">(</span><span class="s1">&#39;keyword&#39;</span><span class="p">,</span> <span class="n">StringType</span><span class="p">(),</span> <span class="bp">False</span><span class="p">),</span>
                     <span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="n">StringType</span><span class="p">(),</span> <span class="bp">False</span><span class="p">),</span>
                     <span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">TimestampType</span><span class="p">(),</span> <span class="bp">False</span><span class="p">),</span>
                     <span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">(),</span> <span class="bp">False</span><span class="p">),</span>
                     <span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;numbers&quot;</span><span class="p">,</span> <span class="n">IntegerType</span><span class="p">(),</span> <span class="bp">False</span><span class="p">),</span>
<span class="p">])</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="err">df = spark.read.csv(file_name, schema=schema, lineSep=&quot;;&quot;)</span>
<span class="err">df.show()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>---------------------------------------------------------------------------

KeyboardInterrupt                         Traceback (most recent call last)

&lt;ipython-input-13-a4fd1b0edcab&gt; in &lt;module&gt;()
      1 df = spark.read.csv(file_name, schema=schema, lineSep=&quot;;&quot;)
----&gt; 2 df.show()


/usr/local/lib/python3.6/dist-packages/pyspark/sql/dataframe.py in show(self, n, truncate, vertical)
    438         &quot;&quot;&quot;
    439         if isinstance(truncate, bool) and truncate:
--&gt; 440             print(self._jdf.showString(n, 20, vertical))
    441         else:
    442             print(self._jdf.showString(n, int(truncate), vertical))


/usr/local/lib/python3.6/dist-packages/py4j/java_gateway.py in __call__(self, *args)
   1301             proto.END_COMMAND_PART
   1302 
-&gt; 1303         answer = self.gateway_client.send_command(command)
   1304         return_value = get_return_value(
   1305             answer, self.gateway_client, self.target_id, self.name)


/usr/local/lib/python3.6/dist-packages/py4j/java_gateway.py in send_command(self, command, retry, binary)
   1031         connection = self._get_connection()
   1032         try:
-&gt; 1033             response = connection.send_command(command)
   1034             if binary:
   1035                 return response, self._create_connection_guard(connection)


/usr/local/lib/python3.6/dist-packages/py4j/java_gateway.py in send_command(self, command)
   1198 
   1199         try:
-&gt; 1200             answer = smart_decode(self.stream.readline()[:-1])
   1201             logger.debug(&quot;Answer received: {0}&quot;.format(answer))
   1202             if answer.startswith(proto.RETURN_MESSAGE):


/usr/lib/python3.6/socket.py in readinto(self, b)
    584         while True:
    585             try:
--&gt; 586                 return self._sock.recv_into(b)
    587             except timeout:
    588                 self._timeout_occurred = True


KeyboardInterrupt:
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">rdd = df.rdd</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="err">rdd.take(10)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>[Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;#澳亚【资讯】# #上海疫情# #上海新增2例本地确诊病例 追踪密接者83人#市卫健委今早（21日）通报：11月20日0—24时，通过口岸联防联控机制，报告9例境外输入性新冠肺炎确诊病例。新增治愈出院8例，其中来自阿联酋1例，来自俄罗斯1例，来自加拿大1例，来自马里1例，来自美国1例，来自塞尔维亚1例，来自乌克兰1例，来自乌兹别克斯坦1例。\n11月20日0—24时，新增2例本地新冠肺炎确诊病例。\n病例1、病例2为夫妻关系，常住浦东新区，因先后出现发热症状，前往医疗机构发热门诊就诊，即被隔离留观。11月20日，市、区疾控中心核酸检测结果为阳性。经专家会诊，综合临床、影像学表现和实验室核酸检测结果，诊断为确诊病例。\n目前，已追踪到其在本市的密切接触者83人，均已落实集中隔离观察。对病例曾活动过的场所已进行终末消毒。\n截至11月20日24时，累计报告境外输入性确诊病例956例，出院896例，在院治疗60例，无重症和危重症。现有待排查的疑似病例0例。\n截至11月20日24时，累计报告本地确诊病例345例，治愈出院335例，在院治疗3例，死亡7例。现有待排查的疑似病例0例。\n截至11月20日24时，尚在医学观察中的无症状感染者0例。 收起全文d&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;【#上海新增2例本地确诊病例#，正全面开展流行病学调查】今天下午，上海浦东新区卫健委报告两例疑似新冠肺炎病例。病例1，男，39岁；病例2，女，34岁，两者系夫妻关系。因先后出现发热，到医院发热门诊就医，即被隔离排查。今晚21时，经上海市疾控中心新冠病毒核酸检测，结果均为阳性。经市级专家会诊，结合临床、影像学表现和实验室核酸检测结果，诊断为新冠肺炎确诊病例。\n目前，上海市、区相关部门已组成联合流调专家队伍，全面开展流行病学调查，正在追踪排查相关人员，对相关人员和环境采取相应的防疫措施。后续排查情况和相关人员的检测结果，将第一时间向社会发布。（总台央视记者陆学贤） 收起全文d&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;【#张文宏称上海新增病例仍属散发病例#】\n11月21日，上海市举行新冠肺炎疫情防控新闻发布会。张文宏在会上说，上海上一例散发病例的处理已完满结束，这意味着，此前上海针对病例的全面布控、快速反应、精准防控非常有效。按照11月20日#上海新增2例本地确诊病例#的轨迹，目前没有看到交叉点，这2例病例的出现与浦东机场物流有关，严格意义上这不能说是两波，应该精确定义为2个散发病例。L中新视频的微博视频 #疾病预防# 收起全文d&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;【#张文宏称上海新增病例仍属散发病例#】\n11月21日，上海市举行新冠肺炎疫情防控新闻发布会。张文宏在会上说，上海上一例散发病例的处理已完满结束，这意味着，此前上海针对病例的全面布控、快速反应、精准防控非常有效。按照11月20日#上海新增2例本地确诊病例#的轨迹，目前没有看到交叉点，这2例病例 展开全文c&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;最近一段时间，国内本土新增确诊病例略有反弹，目前传染源暂时没有公布行程轨迹呢也要尽快公布出来，冬天了，建议大家呢口罩戴上。#上海新增2例本地确诊病例#&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;#上海新增2例本地确诊病例#\n赶紧打开电视关注上海疫情！\n目前事发小区还未封闭！\n只是做人员隔离和核酸检测！&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;#上海新增2例本地确诊病例# 现在已经有了消息，说是这两个病历和以前的病例没有关联，而且这病历中的女方是医院的护理人员。这样就麻烦了，说明还有新的传染源。\n#上海浦东医院4015人被隔离# 赶快找准源头，切断传播途径，不然隐患太大。但也不要过于紧张，毕竟只是发现个别病例，没有大范围蔓延开。\n上海真的太难了，要接待这么多国外的感染者，又要承运那么多的进口冷链海鲜，期待上海恢复，上海加油！ 收起全文d&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;#上海新增2例本地确诊病例# 现在已经有了消息，说是这两个病历和以前的病例没有关联，而且这病历中的女方是医院的护理人员。这样就麻烦了，说明还有新的传染源。\n#上海浦东医院4015人被隔离# 赶快找准源头，切断传播途径，不然隐患太大。但也不要过于紧张，毕竟只是发现个别病例，没有大范围蔓延开。 展开全文c&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;#上海新增2例本地确诊病例# 【上海昨日新增2例本地新冠肺炎确诊病例 新增境外输入9例】据上海市卫健委通报，11月20日0—24时，通过口岸联防联控机制，报告9例境外输入性新冠肺炎确诊病例。11月20日0—24时，新增2例本地新冠肺炎确诊病例。目前，已追踪到其在本市的密切接触者83人，均已落实集中隔离观察。对病例曾活动过的场所已进行终末消毒。 收起全文d&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658),
 Row(keyword=&#39;上海新增2例本地确诊病例&#39;, content=&#39;#上海新增2例本地确诊病例# 【上海昨日新增2例本地新冠肺炎确诊病例 新增境外输入9例】据上海市卫健委通报，11月20日0—24时，通过口岸联防联控机制，报告9例境外输入性新冠肺炎确诊病例。11月20日0—24时，新增2例本地新冠肺炎确诊病例。目前，已追踪到其在本市的密切接触者83人，均已落实集中隔离 展开全文c&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 673058), rank=49, numbers=108658)]
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
</code></pre></div>

<h1 id="translation">Translation<a class="headerlink" href="#translation" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="err">data = pd.read_csv(&quot;Sina_keyword.csv&quot;, error_bad_lines=False, names=[&#39;Keyword&#39;, &#39;Content&#39;, &#39;Time&#39;, &#39;Rank&#39;, &#39;Number&#39;])</span>
<span class="err">data = data[:100]</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">tqdm.auto</span> <span class="kn">import</span> <span class="n">tqdm</span>


<span class="n">tqdm</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
<span class="n">translator</span> <span class="o">=</span> <span class="n">Translator</span><span class="p">()</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="err">translator.translate(&quot;你好&quot;).text</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>&#39;你好&#39;
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="k">translate</span><span class="p">(</span><span class="k">index</span><span class="p">:</span> <span class="n">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">str</span><span class="p">):</span>
    <span class="n">has_translated</span> <span class="o">=</span> <span class="k">False</span>
    <span class="n">while</span> <span class="k">not</span> <span class="n">has_translated</span><span class="p">:</span>
        <span class="n">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">translator</span><span class="p">.</span><span class="k">translate</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">except</span> <span class="k">Exception</span><span class="p">:</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">continue</span>


<span class="k">data</span><span class="p">[</span><span class="s1">&#39;Content_Translation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">data</span><span class="p">.</span><span class="n">progress_apply</span><span class="p">(</span><span class="n">lambda</span> <span class="k">row</span><span class="p">:</span> <span class="k">translate</span><span class="p">(</span><span class="k">row</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="k">row</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>HBox(children=(FloatProgress(value=0.0, max=333717.0), HTML(value=&#39;&#39;)))



---------------------------------------------------------------------------

KeyboardInterrupt                         Traceback (most recent call last)

&lt;ipython-input-51-28c2eb176f38&gt; in &lt;module&gt;()
      9 
     10 
---&gt; 11 data[&#39;Content_Translation&#39;] = data.progress_apply(lambda row: translate(row.name, row[&#39;Content&#39;]), axis=1)


/usr/local/lib/python3.6/dist-packages/tqdm/std.py in inner(df, func, *args, **kwargs)
    751                 # Apply the provided function (in **kwargs)
    752                 # on the df using our wrapper (which provides bar updating)
--&gt; 753                 result = getattr(df, df_function)(wrapper, **kwargs)
    754 
    755                 # Close bar and return pandas calculation result


/usr/local/lib/python3.6/dist-packages/pandas/core/frame.py in apply(self, func, axis, raw, result_type, args, **kwds)
   7550             kwds=kwds,
   7551         )
-&gt; 7552         return op.get_result()
   7553 
   7554     def applymap(self, func) -&gt; &quot;DataFrame&quot;:


/usr/local/lib/python3.6/dist-packages/pandas/core/apply.py in get_result(self)
    178             return self.apply_raw()
    179 
--&gt; 180         return self.apply_standard()
    181 
    182     def apply_empty_result(self):


/usr/local/lib/python3.6/dist-packages/pandas/core/apply.py in apply_standard(self)
    269 
    270     def apply_standard(self):
--&gt; 271         results, res_index = self.apply_series_generator()
    272 
    273         # wrap results


/usr/local/lib/python3.6/dist-packages/pandas/core/apply.py in apply_series_generator(self)
    298                 for i, v in enumerate(series_gen):
    299                     # ignore SettingWithCopy here in case the user mutates
--&gt; 300                     results[i] = self.f(v)
    301                     if isinstance(results[i], ABCSeries):
    302                         # If we have a view on v, we need to make a copy because


/usr/local/lib/python3.6/dist-packages/tqdm/std.py in wrapper(*args, **kwargs)
    747                     # take a fast or slow code path; so stop when t.total==t.n
    748                     t.update(n=1 if not t.total or t.n &lt; t.total else 0)
--&gt; 749                     return func(*args, **kwargs)
    750 
    751                 # Apply the provided function (in **kwargs)


&lt;ipython-input-51-28c2eb176f38&gt; in &lt;lambda&gt;(row)
      9 
     10 
---&gt; 11 data[&#39;Content_Translation&#39;] = data.progress_apply(lambda row: translate(row.name, row[&#39;Content&#39;]), axis=1)


&lt;ipython-input-51-28c2eb176f38&gt; in translate(index, content)
      3     while not has_translated:
      4         try:
----&gt; 5             return translator.translate(content)
      6         except Exception:
      7             sleep(1)


/usr/local/lib/python3.6/dist-packages/googletrans/client.py in translate(self, text, dest, src, **kwargs)
    180 
    181         origin = text
--&gt; 182         data = self._translate(text, dest, src, kwargs)
    183 
    184         # this code will be updated when the format is changed.


/usr/local/lib/python3.6/dist-packages/googletrans/client.py in _translate(self, text, dest, src, override)
     81 
     82         url = urls.TRANSLATE.format(host=self._pick_service_url())
---&gt; 83         r = self.client.get(url, params=params)
     84 
     85         if r.status_code == 200:


/usr/local/lib/python3.6/dist-packages/httpx/_client.py in get(self, url, params, headers, cookies, auth, allow_redirects, timeout)
    761             auth=auth,
    762             allow_redirects=allow_redirects,
--&gt; 763             timeout=timeout,
    764         )
    765


/usr/local/lib/python3.6/dist-packages/httpx/_client.py in request(self, method, url, data, files, json, params, headers, cookies, auth, allow_redirects, timeout)
    599         )
    600         return self.send(
--&gt; 601             request, auth=auth, allow_redirects=allow_redirects, timeout=timeout,
    602         )
    603


/usr/local/lib/python3.6/dist-packages/httpx/_client.py in send(self, request, stream, auth, allow_redirects, timeout)
    619 
    620         response = self.send_handling_redirects(
--&gt; 621             request, auth=auth, timeout=timeout, allow_redirects=allow_redirects,
    622         )
    623


/usr/local/lib/python3.6/dist-packages/httpx/_client.py in send_handling_redirects(self, request, auth, timeout, allow_redirects, history)
    646 
    647             response = self.send_handling_auth(
--&gt; 648                 request, auth=auth, timeout=timeout, history=history
    649             )
    650             response.history = list(history)


/usr/local/lib/python3.6/dist-packages/httpx/_client.py in send_handling_auth(self, request, history, auth, timeout)
    682         request = next(auth_flow)
    683         while True:
--&gt; 684             response = self.send_single_request(request, timeout)
    685             if auth.requires_response_body:
    686                 response.read()


/usr/local/lib/python3.6/dist-packages/httpx/_client.py in send_single_request(self, request, timeout)
    717                 headers=request.headers.raw,
    718                 stream=request.stream,
--&gt; 719                 timeout=timeout.as_dict(),
    720             )
    721         except HTTPError as exc:


/usr/local/lib/python3.6/dist-packages/httpcore/_sync/connection_pool.py in request(self, method, url, headers, stream, timeout)
    151             try:
    152                 response = connection.request(
--&gt; 153                     method, url, headers=headers, stream=stream, timeout=timeout
    154                 )
    155             except NewConnectionRequired:


/usr/local/lib/python3.6/dist-packages/httpcore/_sync/connection.py in request(self, method, url, headers, stream, timeout)
     76             &quot;connection.request method=%r url=%r headers=%r&quot;, method, url, headers
     77         )
---&gt; 78         return self.connection.request(method, url, headers, stream, timeout)
     79 
     80     def _open_socket(self, timeout: TimeoutDict = None) -&gt; SyncSocketStream:


/usr/local/lib/python3.6/dist-packages/httpcore/_sync/http11.py in request(self, method, url, headers, stream, timeout)
     60             reason_phrase,
     61             headers,
---&gt; 62         ) = self._receive_response(timeout)
     63         stream = SyncByteStream(
     64             iterator=self._receive_response_data(timeout),


/usr/local/lib/python3.6/dist-packages/httpcore/_sync/http11.py in _receive_response(self, timeout)
    113         &quot;&quot;&quot;
    114         while True:
--&gt; 115             event = self._receive_event(timeout)
    116             if isinstance(event, h11.Response):
    117                 break


/usr/local/lib/python3.6/dist-packages/httpcore/_sync/http11.py in _receive_event(self, timeout)
    143 
    144             if event is h11.NEED_DATA:
--&gt; 145                 data = self.socket.read(self.READ_NUM_BYTES, timeout)
    146                 self.h11_state.receive_data(data)
    147             else:


/usr/local/lib/python3.6/dist-packages/httpcore/_backends/sync.py in read(self, n, timeout)
     60             with map_exceptions(exc_map):
     61                 self.sock.settimeout(read_timeout)
---&gt; 62                 return self.sock.recv(n)
     63 
     64     def write(self, data: bytes, timeout: TimeoutDict) -&gt; None:


/usr/lib/python3.6/ssl.py in recv(self, buflen, flags)
    995                     &quot;non-zero flags not allowed in calls to recv() on %s&quot; %
    996                     self.__class__)
--&gt; 997             return self.read(buflen)
    998         else:
    999             return socket.recv(self, buflen, flags)


/usr/lib/python3.6/ssl.py in read(self, len, buffer)
    872             raise ValueError(&quot;Read on closed or unwrapped SSL socket.&quot;)
    873         try:
--&gt; 874             return self._sslobj.read(len, buffer)
    875         except SSLError as x:
    876             if x.args[0] == SSL_ERROR_EOF and self.suppress_ragged_eofs:


/usr/lib/python3.6/ssl.py in read(self, len, buffer)
    631             v = self._sslobj.read(len, buffer)
    632         else:
--&gt; 633             v = self._sslobj.read(len)
    634         return v
    635


KeyboardInterrupt:
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">data.head(10)</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Keyword</th>
      <th>Content</th>
      <th>Time</th>
      <th>Rank</th>
      <th>Number</th>
      <th>Content_Translation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>嫦娥五号</td>
      <td>#嫦娥五号要奔月啦# 【嫦娥五号探测器完成第一次轨道修正】记者从国家航天局获悉，北京时间11...</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>#嫦娥五号要奔月啦# 【嫦娥五号探测器完成第一次轨道修正】记者从国家航天局获悉，北京时间11...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>嫦娥五号</td>
      <td>#嫦娥探月#【加油，嫦娥五号！加油，中国航天！】11月24日凌晨4时30分，#嫦娥五号探月任...</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>#嫦娥探月#【加油，嫦娥五号！加油，中国航天！】11月24日凌晨4时30分，#嫦娥五号探月任...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>嫦娥五号</td>
      <td>#嫦娥五号# 第二次参加长五任务，又一次圆满成功！每次在发射成功的那一刻就非常坚定自己要在航...</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>#嫦娥五号# 第二次参加长五任务，又一次圆满成功！每次在发射成功的那一刻就非常坚定自己要在航...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>嫦娥五号</td>
      <td>#嫦娥五号# 第二次参加长五任务，又一次圆满成功！每次在发射成功的那一刻就非常坚定自己要在航...</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>#嫦娥五号# 第二次参加长五任务，又一次圆满成功！每次在发射成功的那一刻就非常坚定自己要在航...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>嫦娥五号</td>
      <td>很好的科普话题，涨知识。\n「嫦娥五号」搭乘「长征五号」火箭发射成功，执行我国首次月球采样返...</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>很好的科普话题，涨知识。\n「嫦娥五号」搭乘「长征五号」火箭发射成功，执行我国首次月球采样返...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>嫦娥五号</td>
      <td>【嫦娥五号发射成功 湖南“神猴”电缆助力探月】11月24日凌晨4时30分，在中国海南文昌发射...</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>【嫦娥五号发射成功 湖南“神猴”电缆助力探月】11月24日凌晨4时30分，在中国海南文昌发射...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>嫦娥五号</td>
      <td>【中国探月工程“三步走”的收官之战打响】11月24日凌晨，中国文昌航天发射场。长征五号遥五运...</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>【中国探月工程“三步走”的收官之战打响】11月24日凌晨，中国文昌航天发射场。长征五号遥五运...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>嫦娥五号</td>
      <td>【嫦娥五号发射成功 湖南“神猴”电缆助力探月】11月24日凌晨4时30分，在中国海南文昌发射...</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>【嫦娥五号发射成功 湖南“神猴”电缆助力探月】11月24日凌晨4时30分，在中国海南文昌发射...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>嫦娥五号</td>
      <td>欧洲航天局：很高兴为嫦娥五号探月提供数据传输支持O欧洲航天局：很高兴为嫦娥五号探月提供数据传输支持</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>欧洲航天局：很高兴为嫦娥五号探月提供数据传输支持O欧洲航天局：很高兴为嫦娥五号探月提供数据传输支持</td>
    </tr>
    <tr>
      <th>9</th>
      <td>嫦娥五号</td>
      <td>关于嫦娥登月，做科研，原来多年前老夫子漫画里也写了\n@Steed的围脖 #嫦娥五号#</td>
      <td>2020-11-25 04:05:07.419591+00</td>
      <td>49.0</td>
      <td>107064.0</td>
      <td>关于嫦娥登月，做科研，原来多年前老夫子漫画里也写了\n@Steed的围脖 #嫦娥五号#</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="preprocess-data">preprocess data<a class="headerlink" href="#preprocess-data" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">preprocess</span><span class="p">(</span><span class="k">row</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="k">row</span><span class="p">.</span><span class="n">asDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]:</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">].</span><span class="k">replace</span><span class="p">(</span><span class="ss">&quot;展开全文c&quot;</span><span class="p">,</span> <span class="ss">&quot;&quot;</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">].</span><span class="k">replace</span><span class="p">(</span><span class="ss">&quot;收起全文d&quot;</span><span class="p">,</span> <span class="ss">&quot;&quot;</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">].</span><span class="k">replace</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;{d[&#39;keyword&#39;]}&quot;</span><span class="p">,</span> <span class="ss">&quot;&quot;</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">].</span><span class="k">replace</span><span class="p">(</span><span class="ss">&quot;#&quot;</span><span class="p">,</span> <span class="ss">&quot;&quot;</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">].</span><span class="k">replace</span><span class="p">(</span><span class="ss">&quot;\n&quot;</span><span class="p">,</span> <span class="ss">&quot;&quot;</span><span class="p">)</span>
    <span class="n">new_row</span> <span class="o">=</span> <span class="k">Row</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_row</span>

<span class="n">new_data</span> <span class="o">=</span> <span class="n">rdd</span><span class="p">.</span><span class="k">map</span><span class="p">(</span><span class="n">preprocess</span><span class="p">)</span>
<span class="n">print</span><span class="p">(</span><span class="n">new_data</span><span class="p">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">new_data</span><span class="p">.</span><span class="k">cache</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>[Row(keyword=&#39;aespa出道曲初舞台&#39;, content=&#39;我对aespa真香了&#39;, time=datetime.datetime(2020, 11, 19, 13, 4, 5, 14218), rank=41, numbers=206090), Row(keyword=&#39;天津大学一教授被实名举报学术造假&#39;, content=&#39;刚刚吃饭的时候看着天大老师造假的事，气愤的不行，然后就收到了我师妹的消息，笑的不行，分享一个我迷糊老师的日常，我们平常比做实验更重要的事就是带钥匙🔑，不然可能出去上个厕所，就进不去实验室了另外请大家不要因为各别老师，而对整个学术业失望，还是有很多老师，很多学生在为这个行 &#39;, time=datetime.datetime(2020, 11, 20, 5, 4, 30, 310980), rank=9, numbers=1043499), Row(keyword=&#39;选秀中的心脏狙击名场面&#39;, content=&#39;\ue627任豪POI rh既然提到了豪豪，那就来看看吧！@R1SE-任豪&#39;, time=datetime.datetime(2020, 11, 20, 20, 4, 20, 475064), rank=47, numbers=21300), Row(keyword=&#39;电视剧半生缘改名情深缘起&#39;, content=&#39;不知道是广电有毛病还是怎样，动不动给人电视剧赐名改名，孤城闭，撒野，半生缘，掌中之物，人家名字多好听，改你🐴 哦，就知道瞎改，电视剧运气都给你改掉一半…&#39;, time=datetime.datetime(2020, 11, 20, 22, 5, 5, 155120), rank=16, numbers=67914), Row(keyword=&#39;跳化粪池救娃退役军人收到救助金&#39;, content=&#39;以后还会继续做好事、好样的！真的令人敬佩！&#39;, time=datetime.datetime(2020, 11, 21, 6, 5, 1, 624606), rank=10, numbers=714340), Row(keyword=&#39;武则天她妈在钦州研究工作组更名&#39;, content=&#39;白富美曹译文的新瓜投稿，波士顿大学gpa低于2.0被退学，在美国读研期间还被诈骗差点被绑架..骗子大概就是骗她：你爹在国内惹上了大麻烦 叫她切断和家人的一切联系并且躲在酒店里…结果她不但信了 还拔了sim卡 乖乖照做 她爹当时着实被吓到 她爹还是有点人脉吧 动用了很多关系 几乎发动了相当大 &#39;, time=datetime.datetime(2020, 11, 19, 22, 4, 52, 666638), rank=1, numbers=291907), Row(keyword=&#39;秋日栗栗排骨饭&#39;, content=&#39;【板栗炖排骨】板栗软糯香甜，和排骨一起炖到软烂，酱油的咸味和板栗的甜味融合在一起，让人无法抗拒～微博厨房大赛 via：好好吃 L最爱学做饭的微博视频&#39;, time=datetime.datetime(2020, 11, 20, 19, 3, 55, 682688), rank=48, numbers=29242), Row(keyword=&#39;隐秘而伟大&#39;, content=&#39;\ue627金晨严重剧透慎入，都是超级喜欢的片段电视剧&#39;, time=datetime.datetime(2020, 11, 19, 17, 4, 54, 423157), rank=30, numbers=197616), Row(keyword=&#39;单依纯好声音冠军&#39;, content=&#39; 呜呜呜呜不愧是我滴女神太棒啦！！！！！虽然是意料之中 但是还是忍不住非常激动&#39;, time=datetime.datetime(2020, 11, 21, 3, 4, 26, 288909), rank=12, numbers=379689), Row(keyword=&#39;丁放背叛顾耀东&#39;, content=&#39;隐秘而伟大 第37-38集预告：顾耀东选择主动回警局，回警局之后顾耀东被指认通共，在警局惨遭酷刑，心疼东鹅李易峰/金晨/ L影视小果酱的微博视频&#39;, time=datetime.datetime(2020, 11, 19, 23, 3, 58, 114273), rank=37, numbers=90071)]





PythonRDD[33] at RDD at PythonRDD.scala:53
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">jieba.initialize()</span>
<span class="err">tokenizer = jieba.Tokenizer()</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">sentiment</span><span class="p">(</span><span class="k">row</span><span class="p">):</span>
    <span class="n">try</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">SnowNLP</span><span class="p">(</span><span class="k">row</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">row</span><span class="p">.</span><span class="n">keyword</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">sentiments</span><span class="p">,</span> <span class="k">row</span><span class="p">.</span><span class="n">content</span><span class="p">))</span>

    <span class="k">except</span> <span class="k">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="ss">&quot;error&quot;</span><span class="p">,</span> <span class="ss">&quot;nil&quot;</span><span class="p">)</span>

<span class="n">def</span> <span class="n">keyword</span><span class="p">(</span><span class="k">row</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jieba</span><span class="p">.</span><span class="n">lcut</span><span class="p">(</span><span class="k">row</span><span class="p">.</span><span class="n">keyword</span><span class="p">,</span> <span class="n">cut_all</span><span class="o">=</span><span class="k">False</span><span class="p">),</span> <span class="k">row</span>



<span class="n">sentiments</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">.</span><span class="k">map</span><span class="p">(</span><span class="n">sentiment</span><span class="p">).</span><span class="n">filter</span><span class="p">(</span><span class="n">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="ss">&quot;error&quot;</span> <span class="k">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="ss">&quot;nil&quot;</span><span class="p">)</span>
<span class="n">sentiments</span><span class="p">.</span><span class="k">cache</span><span class="p">().</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>[(&#39;aespa出道曲初舞台&#39;, (0.6292287669391688, &#39;我对aespa真香了&#39;)),
 (&#39;天津大学一教授被实名举报学术造假&#39;,
  (0.9952895196778796,
   &#39;刚刚吃饭的时候看着天大老师造假的事，气愤的不行，然后就收到了我师妹的消息，笑的不行，分享一个我迷糊老师的日常，我们平常比做实验更重要的事就是带钥匙🔑，不然可能出去上个厕所，就进不去实验室了另外请大家不要因为各别老师，而对整个学术业失望，还是有很多老师，很多学生在为这个行 &#39;)),
 (&#39;选秀中的心脏狙击名场面&#39;,
  (0.8225709747637443, &#39;\ue627任豪POI rh既然提到了豪豪，那就来看看吧！@R1SE-任豪&#39;)),
 (&#39;电视剧半生缘改名情深缘起&#39;,
  (0.6790462184223255,
   &#39;不知道是广电有毛病还是怎样，动不动给人电视剧赐名改名，孤城闭，撒野，半生缘，掌中之物，人家名字多好听，改你🐴 哦，就知道瞎改，电视剧运气都给你改掉一半…&#39;)),
 (&#39;跳化粪池救娃退役军人收到救助金&#39;, (0.824867218915397, &#39;以后还会继续做好事、好样的！真的令人敬佩！&#39;)),
 (&#39;武则天她妈在钦州研究工作组更名&#39;,
  (0.37617857183276393,
   &#39;白富美曹译文的新瓜投稿，波士顿大学gpa低于2.0被退学，在美国读研期间还被诈骗差点被绑架..骗子大概就是骗她：你爹在国内惹上了大麻烦 叫她切断和家人的一切联系并且躲在酒店里…结果她不但信了 还拔了sim卡 乖乖照做 她爹当时着实被吓到 她爹还是有点人脉吧 动用了很多关系 几乎发动了相当大 &#39;)),
 (&#39;秋日栗栗排骨饭&#39;,
  (0.9999301000032879,
   &#39;【板栗炖排骨】板栗软糯香甜，和排骨一起炖到软烂，酱油的咸味和板栗的甜味融合在一起，让人无法抗拒～微博厨房大赛 via：好好吃 L最爱学做饭的微博视频&#39;)),
 (&#39;隐秘而伟大&#39;, (0.9961075258005379, &#39;\ue627金晨严重剧透慎入，都是超级喜欢的片段电视剧&#39;)),
 (&#39;单依纯好声音冠军&#39;, (0.9996645862980169, &#39; 呜呜呜呜不愧是我滴女神太棒啦！！！！！虽然是意料之中 但是还是忍不住非常激动&#39;)),
 (&#39;丁放背叛顾耀东&#39;,
  (0.9984970249089633,
   &#39;隐秘而伟大 第37-38集预告：顾耀东选择主动回警局，回警局之后顾耀东被指认通共，在警局惨遭酷刑，心疼东鹅李易峰/金晨/ L影视小果酱的微博视频&#39;))]
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">groupValues</span><span class="p">(</span><span class="k">values</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">v</span> <span class="k">in</span> <span class="k">values</span><span class="p">:</span>
        <span class="n">sentiments</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">v</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">sentiments</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">total</span> <span class="o">/</span> <span class="n">i</span>

<span class="n">grouped</span> <span class="o">=</span> <span class="n">sentiments</span><span class="p">.</span><span class="n">groupByKey</span><span class="p">().</span><span class="n">mapValues</span><span class="p">(</span><span class="n">groupValues</span><span class="p">)</span>
<span class="n">print</span><span class="p">(</span><span class="n">grouped</span><span class="p">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>---------------------------------------------------------------------------

KeyboardInterrupt                         Traceback (most recent call last)

&lt;ipython-input-28-0b92fc34bf9d&gt; in &lt;module&gt;()
     10 
     11 grouped = sentiments.groupByKey().mapValues(groupValues)
---&gt; 12 print(grouped.take(10))


/usr/local/lib/python3.6/dist-packages/pyspark/rdd.py in take(self, num)
   1444 
   1445             p = range(partsScanned, min(partsScanned + numPartsToTry, totalParts))
-&gt; 1446             res = self.context.runJob(self, takeUpToNumLeft, p)
   1447 
   1448             items += res


/usr/local/lib/python3.6/dist-packages/pyspark/context.py in runJob(self, rdd, partitionFunc, partitions, allowLocal)
   1116         # SparkContext#runJob.
   1117         mappedRDD = rdd.mapPartitions(partitionFunc)
-&gt; 1118         sock_info = self._jvm.PythonRDD.runJob(self._jsc.sc(), mappedRDD._jrdd, partitions)
   1119         return list(_load_from_socket(sock_info, mappedRDD._jrdd_deserializer))
   1120


/usr/local/lib/python3.6/dist-packages/py4j/java_gateway.py in __call__(self, *args)
   1301             proto.END_COMMAND_PART
   1302 
-&gt; 1303         answer = self.gateway_client.send_command(command)
   1304         return_value = get_return_value(
   1305             answer, self.gateway_client, self.target_id, self.name)


/usr/local/lib/python3.6/dist-packages/py4j/java_gateway.py in send_command(self, command, retry, binary)
   1031         connection = self._get_connection()
   1032         try:
-&gt; 1033             response = connection.send_command(command)
   1034             if binary:
   1035                 return response, self._create_connection_guard(connection)


/usr/local/lib/python3.6/dist-packages/py4j/java_gateway.py in send_command(self, command)
   1198 
   1199         try:
-&gt; 1200             answer = smart_decode(self.stream.readline()[:-1])
   1201             logger.debug(&quot;Answer received: {0}&quot;.format(answer))
   1202             if answer.startswith(proto.RETURN_MESSAGE):


/usr/lib/python3.6/socket.py in readinto(self, b)
    584         while True:
    585             try:
--&gt; 586                 return self._sock.recv_into(b)
    587             except timeout:
    588                 self._timeout_occurred = True


KeyboardInterrupt:
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">pos = sentiments.filter(lambda x: x[1][0] &gt; 0.75).count()</span>
<span class="err">neg = sentiments.filter(lambda x: x[1][0] &lt;= 0.35).count()</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="err">net = sentiments.filter(lambda x: x[1][0] &gt; 0.35 and x[1][0] &lt;= 0.75).count()</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="err">plt.figure(figsize=(10,10))</span>
<span class="err">plt.bar(&quot;Positive&quot;, pos)</span>
<span class="err">plt.bar(&quot;Neutral&quot;, net)</span>
<span class="err">plt.bar(&quot;Negative&quot;, neg)</span>
<span class="err">plt.xlabel(&quot;Sentiment&quot;)</span>
<span class="err">plt.ylabel(&quot;Number of posts&quot;)</span>
<span class="err">plt.title(&quot;Sina Weibo Sentiment&quot;)</span>
<span class="err">plt.savefig(&quot;sina.png&quot;)</span>
</code></pre></div>

<p><img alt="png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAncAAAJcCAYAAACboYKXAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3de5xeZX3v/c9XAhQVCEjKVoINW2MtokWIiLVVK24OHsBaD/hYDcgjbcWqrbaiteJZ3N2KujeyyxY0uH0ERKtRUUwRxVo5BFGOWiKgBEGjIKAoCP6eP+5r5HacmUwmc8+EK5/36zWvWeta11rrd8fb8M211rVWqgpJkiT14T7zXYAkSZJmj+FOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0nzIskLknxhvuuYSpLXJflAW16SpJIsmO+6NkSSByf5aZIt5rsWSXPDcCdpZJL8cZL/SHJLkpuSfDXJYwCq6iNVtf8IzvkvSU4YWt8yyc8madt3qmNV1dur6v8dQY1bJXlXkrUteF2b5D2zdOxrkzxlbL2qvldV96+qu2fj+BtYSyV56FyfV9rcGe4kjUSS7YDPAP8T2BHYBXgTcMeIT30u8ISh9WXA94A/GdcGcNGIa5nMa1sN+wDbAk8Cvj5PtUjqjOFO0qg8DKCqPlpVd1fVz6vqC1V1CUCSw5L8+1jnNsrzV0muSvKTJMcnSdv2kCRfTPLjJD9K8pEkCyc577nAHyTZqa3/CXAqcL9xbV+rql8meVCSjydZl+SaJC8fqumNSf7vuOO/OMn3k9yQ5NVDfbdO8p627ftteetJanwM8K9V9f0auLaqThk61vpqOj3JKUluS3J5kmVt24eBBwOfbiOC/zD+cnKSLyV5axtR/WmSTyd5QPszvTXJhUmWDJ3v4UlWtZHXbyd57tC2D7X/nT7bajk/yUPatnNbt2+28zxvkj8LSbPMcCdpVP4TuDvJiiQHJdlhGvs8nUHweRTwXOCA1h7gHcCDgD8AdgXeONEBquo64LvcM1L3BOArwH+Mazs3yX2ATwPfZDCyuB/wyiQHMLk/BZYC+wOvGboE+o/AvsCewB8yGJV7/STHOA/4uyQvTfLIsRALMM2aDmYQWBcCK4H/1T77CxmMUj6jXYr975Oc/1Dghe34DwG+BnyQwQjrlcAxrZb7AauA/w/43bbf+5PsPu5YbwJ2ANYAb2u1jI2e/mGr5bRJapE0ywx3kkaiqm4F/hgo4P8A65KsTLLzFLsdW1U/qarvAecwCEpU1ZqqWlVVd1TVOuDdwBOnOM6XgSe0oLQPgzD1laG2x7c+jwEWVdWbq+rOqrq61XroFMd+U1X9rKouZRCInt/aXwC8uap+2Gp8E4MANZF3AO9s+6wGrk+yvG2bTk3/XlVntvvoPswgTG6ID1bVd6rqFuBzwHeq6t+q6i7gY8CjW7+nA9dW1Qer6q6quhj4OPCcoWP9a1Vd0Pb9CO1/M0nz514160vSvUtVXQkcBoPLe8D/Bd7DPYFovBuHlm8H7t/23Rl4L4ORt20Z/MP05ilOfS5wFPBI4Oqqur1dAn5Ja9sGOJ/BCNiDkvxkaN8tGATByVw3tPzddjwYjCp+d9y2B010gBbKjgeOT7IN8GLg5CQXAL83jZrG/zn9TpIFLWBNxw+Gln8+wfr92/LvAY8dV8sCBoFyslruj6R55cidpDlRVd8CPgTsMYPd385gBPCRVbUd8BcMLtVO5lwGo1lP455QdDmDy7lPAy6sql8wCGrXVNXCoZ9tq+qpUxx716HlBwPfb8vfZxCGJto2qXYv4vEMwuruM6zpNw45zX7TcR3w5XG13L+q/noWzyFplhnuJI1EuxH/VUkWt/VdGYzYnTeDw20L/BS4JckuwN9P1bmq1jAYjXoFLdxVVTEYrXsFg/AHcAFwW5LXJNkmyRZJ9kh7XMsk/inJfZM8AjgcGLuX7KPA65MsahM33sBgpPK3JHllkie1cy5ol2S3BS6eYU3DfgD812n2XZ/PAA9L8sIMHh+zZZLHJPmDeahF0jQZ7iSNym3AY4Hzk/yMQai7DHjVDI71JmAv4Bbgs8AnprHPucAi4KtDbV9hMDHgXPj15dGnM7hP7BrgR8AHgO2nOO6XGUwcOBv4H1U19iDmtzK4f+4S4FIGjzZ56yTHuB14F4NLmj9icAn5z6vq6hnWNOwdDELmT4Zn885EVd3GYOLIoQxGIW9kcK/gZLOAx3sjsKLV8tz1dZY0OzL4x6wkSZJ64MidJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BEfYtzstNNOtWTJkvkuQ5Ikab0uuuiiH1XVoom2Ge6aJUuWsHr16vkuQ5Ikab2SfHeybV6WlSRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6MrJwl+TkJD9MctkE216VpJLs1NaT5H1J1iS5JMleQ32XJ7mq/Swfat87yaVtn/clSWvfMcmq1n9Vkh1G9RklSZI2NaMcufsQcOD4xiS7AvsD3xtqPghY2n6OBE5ofXcEjgEeC+wDHDMU1k4AXjK039i5jgbOrqqlwNltXZIkabMwsnBXVecCN02w6TjgH4AaajsEOKUGzgMWJnkgcACwqqpuqqqbgVXAgW3bdlV1XlUVcArwzKFjrWjLK4baJUmSujen99wlOQS4vqq+OW7TLsB1Q+trW9tU7WsnaAfYuapuaMs3AjtPUc+RSVYnWb1u3boN/TiSJEmbnAVzdaIk9wVex+CS7JyoqkpSU2w/ETgRYNmyZZP2my1Ljv7sqE+hzl177NPmuwRJ0iZuLkfuHgLsBnwzybXAYuDrSf4LcD2w61Dfxa1tqvbFE7QD/KBdtqX9/uGsfxJJkqRN1JyFu6q6tKp+t6qWVNUSBpdS96qqG4GVwIvarNl9gVvapdWzgP2T7NAmUuwPnNW23Zpk3zZL9kXAp9qpVgJjs2qXD7VLkiR1b5SPQvko8DXg95OsTXLEFN3PBK4G1gD/B3gpQFXdBLwFuLD9vLm10fp8oO3zHeBzrf1Y4L8luQp4SluXJEnaLIzsnruqev56ti8ZWi7gqEn6nQycPEH7amCPCdp/DOy3geVKkiR1wTdUSJIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHVkZOEuyclJfpjksqG2f07yrSSXJPnXJAuHtr02yZok305ywFD7ga1tTZKjh9p3S3J+az8tyVatfeu2vqZtXzKqzyhJkrSpGeXI3YeAA8e1rQL2qKpHAf8JvBYgye7AocAj2j7vT7JFki2A44GDgN2B57e+AO8EjquqhwI3A0e09iOAm1v7ca2fJEnSZmFk4a6qzgVuGtf2haq6q62eByxuy4cAp1bVHVV1DbAG2Kf9rKmqq6vqTuBU4JAkAZ4MnNH2XwE8c+hYK9ryGcB+rb8kSVL35vOeuxcDn2vLuwDXDW1b29oma38A8JOhoDjW/hvHattvaf1/S5Ijk6xOsnrdunUb/YEkSZLm27yEuyT/CNwFfGQ+zj+mqk6sqmVVtWzRokXzWYokSdKsWDDXJ0xyGPB0YL+qqtZ8PbDrULfFrY1J2n8MLEyyoI3ODfcfO9baJAuA7Vt/SZKk7s3pyF2SA4F/AA6uqtuHNq0EDm0zXXcDlgIXABcCS9vM2K0YTLpY2ULhOcCz2/7LgU8NHWt5W3428MWhEClJktS1kY3cJfko8CRgpyRrgWMYzI7dGljV5jicV1V/VVWXJzkduILB5dqjqurudpyXAWcBWwAnV9Xl7RSvAU5N8lbgYuCk1n4S8OEkaxhM6Dh0VJ9RkiRpUzOycFdVz5+g+aQJ2sb6vw142wTtZwJnTtB+NYPZtOPbfwE8Z4OKlSRJ6oRvqJAkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqyMjCXZKTk/wwyWVDbTsmWZXkqvZ7h9aeJO9LsibJJUn2Gtpneet/VZLlQ+17J7m07fO+JJnqHJIkSZuDUY7cfQg4cFzb0cDZVbUUOLutAxwELG0/RwInwCCoAccAjwX2AY4ZCmsnAC8Z2u/A9ZxDkiSpeyMLd1V1LnDTuOZDgBVteQXwzKH2U2rgPGBhkgcCBwCrquqmqroZWAUc2LZtV1XnVVUBp4w71kTnkCRJ6t5c33O3c1Xd0JZvBHZuy7sA1w31W9vapmpfO0H7VOf4LUmOTLI6yep169bN4ONIkiRtWuZtQkUbcav5PEdVnVhVy6pq2aJFi0ZZiiRJ0pyY63D3g3ZJlfb7h639emDXoX6LW9tU7YsnaJ/qHJIkSd2b63C3Ehib8boc+NRQ+4varNl9gVvapdWzgP2T7NAmUuwPnNW23Zpk3zZL9kXjjjXROSRJkrq3YFQHTvJR4EnATknWMpj1eixwepIjgO8Cz23dzwSeCqwBbgcOB6iqm5K8Bbiw9XtzVY1N0ngpgxm52wCfaz9McQ5JkqTujSzcVdXzJ9m03wR9CzhqkuOcDJw8QftqYI8J2n880TkkSZI2B76hQpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOrDfcJfnvSbZLsmWSs5OsS/IXc1GcJEmSNsx0Ru72r6pbgacD1wIPBf5+lEVJkiRpZqYT7rZsv58GfKyqbhlhPZIkSdoIC6bR59NJvgX8HPjrJIuAX4y2LEmSJM3EdEbujgH+CFhWVb8EbgcOHmlVkiRJmpHphLuvVdVNVXU3QFX9DPjcaMuSJEnSTEx6WTbJfwF2AbZJ8mggbdN2wH3noDZJkiRtoKnuuTsAOAxYDLx7qP024HUjrEmSJEkzNGm4q6oVwIokf15VH5/DmiRJkjRD07nnbnF7iHGSfCDJ15PsP/LKJEmStMGmE+5e3B5ivD/wAOCFwLEjrUqSJEkzMp1wNzaR4qnAKVV1+VDbjCT52ySXJ7ksyUeT/E6S3ZKcn2RNktOSbNX6bt3W17TtS4aO89rW/u0kBwy1H9ja1iQ5emNqlSRJujeZTri7KMkXGIS7s5JsC/xqpidMsgvwcgbPzdsD2AI4FHgncFxVPRS4GTii7XIEcHNrP671I8nubb9HAAcC70+yRZItgOOBg4Ddgee3vpIkSd2bTrg7AjgaeExV3Q5sBRy+keddwOARKwsYPFblBuDJwBlt+wrgmW35kLZO275fkrT2U6vqjqq6BlgD7NN+1lTV1VV1J3Bq6ytJktS99b5+rKp+lWQx8P8MMhVfrqpPz/SEVXV9kv8BfI/BK82+AFwE/KSq7mrd1jJ4xh7t93Vt37uS3MLg3r9dgPOGDj28z3Xj2h87US1JjgSOBHjwgx88048kSZK0yVjvyF2SY4FXAFe0n5cneftMT5hkBwYjabsBDwLux+Cy6pyrqhOrallVLVu0aNF8lCBJkjSr1jtyx+Beuz2r6lcASVYAFzPzBxk/Bbimqta1430CeDywMMmCNnq3GLi+9b8e2BVY2y7jbg/8eKh9zPA+k7VLkiR1bTr33AEsHFrefiPP+T1g3yT3bffO7cdgRPAc4Nmtz3LgU215ZVunbf9iVVVrP7TNpt0NWApcAFwILG2zb7diMOli5UbWLEmSdK8wnZG7dwAXJzmHwSNQnsBggsWMVNX5Sc4Avg7cxWAU8ETgs8CpSd7a2k5qu5wEfDjJGuAmBmGNqro8yekMguFdwFFVdTdAkpcBZzGYiXtye3yLJElS9zIYBFtPp+SBwGOAAi6sqhtHXdhcW7ZsWa1evXqk51hy9GdHenz179pjnzbfJUiSNgFJLqqqZRNtm87IHcDjgD9mEO4WAP86S7VJkiRpFk1ntuz7gb8CLgUuA/4yyfGjLkySJEkbbjojd08G/qBNYhibLes9bJIkSZug6cyWXQMMP+F319YmSZKkTcx0Ru62Ba5McgGDe+72AVYnWQlQVQePsD5JkiRtgOmEuzeMvApJkiTNium8W/bLc1GIJEmSNt5031AhSZKkewHDnSRJUkcmDXdJzm6/3zl35UiSJGljTHXP3QOT/BFwcJJTGbxX9teq6usjrUySJEkbbKpw9wbgn4DFwLvHbSsGDzeWJEnSJmTScFdVZwBnJPmnqnrLHNYkSZKkGZrOo1DekuRg4Amt6UtV9ZnRliVJkqSZWO9s2STvAF4BXNF+XpHk7aMuTJIkSRtuOm+oeBqwZ1X9CiDJCuBi4HWjLEySJEkbbrrPuVs4tLz9KAqRJEnSxpvOyN07gIuTnMPgcShPAI4eaVWSJEmakelMqPhoki8Bj2lNr6mqG0dalSRJkmZkOiN3VNUNwMoR1yJJkqSN5LtlJUmSOmK4kyRJ6siU4S7JFkm+NVfFSJIkaeNMGe6q6m7g20kePEf1SJIkaSNMZ0LFDsDlSS4AfjbWWFUHj6wqSZIkzch0wt0/jbwKSZIkzYrpPOfuy0l+D1haVf+W5L7AFqMvTZIkSRtqvbNlk7wEOAP4l9a0C/DJURYlSZKkmZnOo1COAh4P3ApQVVcBvzvKoiRJkjQz0wl3d1TVnWMrSRYANbqSJEmSNFPTCXdfTvI6YJsk/w34GPDp0ZYlSZKkmZhOuDsaWAdcCvwlcCbw+lEWJUmSpJmZzmzZXyVZAZzP4HLst6vKy7KSJEmboPWGuyRPA/438B0gwG5J/rKqPjfq4iRJkrRhpvMQ43cBf1pVawCSPAT4LGC4kyRJ2sRM556728aCXXM1cNuI6pEkSdJGmHTkLsmz2uLqJGcCpzO45+45wIVzUJskSZI20FSXZZ8xtPwD4IlteR2wzcgqkiRJ0oxNGu6q6vC5LESSJEkbbzqzZXcD/gZYMty/qg4eXVmSJEmaienMlv0kcBKDt1L8arTlSJIkaWNMJ9z9oqreN/JKJEmStNGmE+7em+QY4AvAHWONVfX1kVUlSZKkGZlOuHsk8ELgydxzWbbauiRJkjYh0wl3zwH+a1XdOepiJEmStHGm84aKy4CFoy5EkiRJG286I3cLgW8luZDfvOfOR6FIkiRtYqYT7o4ZeRWSJEmaFesNd1X15bkoRJIkSRtvOm+ouI3B7FiArYAtgZ9V1XajLEySJEkbbjojd9uOLScJcAiw7yiLkiRJ0sxMZ7bsr9XAJ4EDRlSPJEmSNsJ0Lss+a2j1PsAy4Bcjq0iSJEkzNp3Zss8YWr4LuJbBpVlJkiRtYqZzz93hc1GIJEmSNt6k4S7JG6bYr6rqLSOoR5IkSRthqpG7n03Qdj/gCOABgOFOkiRpEzNpuKuqd40tJ9kWeAVwOHAq8K7J9pMkSdL8mfKeuyQ7An8HvABYAexVVTfPRWGSJEnacFPdc/fPwLOAE4FHVtVP56wqSZIkzchUDzF+FfAg4PXA95Pc2n5uS3Lr3JQnSZKkDTHVPXcb9PYKSZIkzT8DnCRJUkcMd5IkSR0x3EmSJHVkXsJdkoVJzkjyrSRXJnlckh2TrEpyVfu9Q+ubJO9LsibJJUn2GjrO8tb/qiTLh9r3TnJp2+d9STIfn1OSJGmuzdfI3XuBz1fVw4E/BK4EjgbOrqqlwNltHeAgYGn7ORI4AX79DL5jgMcC+wDHjAXC1uclQ/sdOAefSZIkad7NebhLsj3wBOAkgKq6s6p+AhzC4EHJtN/PbMuHAKfUwHnAwiQPBA4AVlXVTe3ByquAA9u27arqvKoq4JShY0mSJHVtPkbudgPWAR9McnGSDyS5H7BzVd3Q+twI7NyWdwGuG9p/bWubqn3tBO2/JcmRSVYnWb1u3bqN/FiSJEnzbz7C3QJgL+CEqno08DPuuQQLQBtxq1EXUlUnVtWyqlq2aNGiUZ9OkiRp5OYj3K0F1lbV+W39DAZh7wftkirt9w/b9uuBXYf2X9zapmpfPEG7JElS9+Y83FXVjcB1SX6/Ne0HXAGsBMZmvC4HPtWWVwIvarNm9wVuaZdvzwL2T7JDm0ixP3BW23Zrkn3bLNkXDR1LkiSpa5O+fmzE/gb4SJKtgKuBwxkEzdOTHAF8F3hu63sm8FRgDXB760tV3ZTkLcCFrd+bq+qmtvxS4EPANsDn2o8kSVL35iXcVdU3gGUTbNpvgr4FHDXJcU4GTp6gfTWwx0aWKUmSdK/jGyokSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6siC+S5AkqRNySNXPHK+S9C93KXLL53X8ztyJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHZm3cJdkiyQXJ/lMW98tyflJ1iQ5LclWrX3rtr6mbV8ydIzXtvZvJzlgqP3A1rYmydFz/dkkSZLmy3yO3L0CuHJo/Z3AcVX1UOBm4IjWfgRwc2s/rvUjye7AocAjgAOB97fAuAVwPHAQsDvw/NZXkiSpe/MS7pIsBp4GfKCtB3gycEbrsgJ4Zls+pK3Ttu/X+h8CnFpVd1TVNcAaYJ/2s6aqrq6qO4FTW19JkqTuzdfI3XuAfwB+1dYfAPykqu5q62uBXdryLsB1AG37La3/r9vH7TNZ+29JcmSS1UlWr1u3bmM/kyRJ0ryb83CX5OnAD6vqork+93hVdWJVLauqZYsWLZrvciRJkjbagnk45+OBg5M8FfgdYDvgvcDCJAva6Nxi4PrW/3pgV2BtkgXA9sCPh9rHDO8zWbskSVLX5nzkrqpeW1WLq2oJgwkRX6yqFwDnAM9u3ZYDn2rLK9s6bfsXq6pa+6FtNu1uwFLgAuBCYGmbfbtVO8fKOfhokiRJ824+Ru4m8xrg1CRvBS4GTmrtJwEfTrIGuIlBWKOqLk9yOnAFcBdwVFXdDZDkZcBZwBbAyVV1+Zx+EkmSpHkyr+Guqr4EfKktX81gpuv4Pr8AnjPJ/m8D3jZB+5nAmbNYqiRJ0r2Cb6iQJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhmmtrp8AAAyNSURBVDtJkqSOGO4kSZI6YriTJEnqiOFOkiSpI4Y7SZKkjhjuJEmSOmK4kyRJ6ojhTpIkqSOGO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqyIL5LkDSvdgbt5/vCnRv98Zb5rsCqTuO3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJH5jzcJdk1yTlJrkhyeZJXtPYdk6xKclX7vUNrT5L3JVmT5JIkew0da3nrf1WS5UPteye5tO3zviSZ688pSZI0H+Zj5O4u4FVVtTuwL3BUkt2Bo4Gzq2opcHZbBzgIWNp+jgROgEEYBI4BHgvsAxwzFghbn5cM7XfgHHwuSZKkeTfn4a6qbqiqr7fl24ArgV2AQ4AVrdsK4Jlt+RDglBo4D1iY5IHAAcCqqrqpqm4GVgEHtm3bVdV5VVXAKUPHkiRJ6tq83nOXZAnwaOB8YOequqFtuhHYuS3vAlw3tNva1jZV+9oJ2ic6/5FJVidZvW7duo36LJIkSZuCeQt3Se4PfBx4ZVXdOrytjbjVqGuoqhOrallVLVu0aNGoTydJkjRy8xLukmzJINh9pKo+0Zp/0C6p0n7/sLVfD+w6tPvi1jZV++IJ2iVJkro3H7NlA5wEXFlV7x7atBIYm/G6HPjUUPuL2qzZfYFb2uXbs4D9k+zQJlLsD5zVtt2aZN92rhcNHUuSJKlrC+bhnI8HXghcmuQbre11wLHA6UmOAL4LPLdtOxN4KrAGuB04HKCqbkryFuDC1u/NVXVTW34p8CFgG+Bz7UeSJKl7cx7uqurfgcmeO7ffBP0LOGqSY50MnDxB+2pgj40oU5Ik6V7JN1RIkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdcRwJ0mS1BHDnSRJUkcMd5IkSR0x3EmSJHXEcCdJktQRw50kSVJHDHeSJEkdMdxJkiR1xHAnSZLUEcOdJElSRwx3kiRJHTHcSZIkdaTbcJfkwCTfTrImydHzXY8kSdJc6DLcJdkCOB44CNgdeH6S3ee3KkmSpNHrMtwB+wBrqurqqroTOBU4ZJ5rkiRJGrkF813AiOwCXDe0vhZ47PhOSY4EjmyrP03y7TmoTVPbCfjRfBexqco757sCzYDf6am8KfNdgTac3+n1yGFz8r3+vck29BrupqWqTgROnO86dI8kq6tq2XzXIc0Wv9Pqjd/pTV+vl2WvB3YdWl/c2iRJkrrWa7i7EFiaZLckWwGHAivnuSZJkqSR6/KybFXdleRlwFnAFsDJVXX5PJel6fEyuXrjd1q98Tu9iUtVzXcNkiRJmiW9XpaVJEnaLBnuJEmSOmK406xIcneSbyS5LMnHktx3A/d/UJIz2vKeSZ46tO1gXyGnuZakkrxraP3VSd44w2MtTPLSGe57bZKdZrKvNJvf4/Wc53Xj1v9jts+h6TPcabb8vKr2rKo9gDuBv9qQnavq+1X17La6J/DUoW0rq+rY2StVmpY7gGfNUrBaCEwY7pJ0ObFNm4zZ/B5P5TfCXVX90YjPpykY7jQKXwEemmTHJJ9MckmS85I8CiDJE9so3zeSXJxk2yRL2qjfVsCbgee17c9LcliS/5Vk+yTfTXKfdpz7JbkuyZZJHpLk80kuSvKVJA+fx8+vPtzFYFbg347fkGRRko8nubD9PL61vzHJq4f6XZZkCXAs8JD2nf7nJE9q39OVwBWt7yfb9/fy9vYcaTbM5Hu8KMmq9l38QPt7d6e27be+p0mOBbZp3++PtLaftt+nJnna0Dk/lOTZSbZo/1+4sP034i9H/iexGTHcaVa1UYiDgEuBNwEXV9WjGPyr7pTW7dXAUVW1J/AnwM/H9m/vAn4DcFobCTxtaNstwDeAJ7ampwNnVdUvGfzl9TdVtXc7/vtH9ym1GTkeeEGS7ce1vxc4rqoeA/w58IH1HOdo4DvtO/33rW0v4BVV9bC2/uL2/V0GvDzJA2bnI0gb/D0+BvhiVT0COAN48NA+v/U9raqjuefqzQvGneM04LkA7R/v+wGfBY4AbmnnfgzwkiS7zdLn3ex5OUCzZZsk32jLXwFOAs5n8BcGVfXFJA9Ish3wVeDd7V94n6iqtcm038N3GvA84BwGD6d+f5L7A38EfGzoOFvPwmfSZq6qbk1yCvByhv4RAjwF2H3o+7Zd+x5uiAuq6pqh9Zcn+bO2vCuwFPjxDMqWfsMMvsd/DPxZ2/fzSW4e2mdDv6efA96bZGvgQODcqvp5kv2BRyUZux1n+3asayY5jjaA4U6z5edtJO7XJgtsVXVsks8yuK/uq0kOAH4xzfOsBN6eZEdgb+CLwP2An4w/vzRL3gN8HfjgUNt9gH2r6je+t0nu4jeviPzOFMf92dB+T2LwH9rHVdXtSb60nn2lDbUh3+MJDzCT72lV/aL1O4DBP8xPHTscg6stZ23oB9H6eVlWo/QV4AXw678UftT+BfmQqrq0qt7J4FVx4++Puw3YdqIDVtVP2z7vBT5TVXdX1a3ANUme086VJH84kk+kzU5V3QSczuAy0pgvAH8ztpJk7B8W1zK43EqSvYCxy0yTfqeb7YGb238wHw7sOyvFS80Gfo+/yj2XUvcHdmjtU31Pf5lky0lOfxpwOIPbcD7f2s4C/npsnyQPS3K/GX48jWO40yi9Edg7ySUMbihf3tpf2W40vwT4JYNh+2HnMLhU8I0kz5vguKcBf9F+j3kBcESSbwKXA4fM3seQeBcwPNvw5cCydiP4FdwzO/zjwI5JLgdeBvwnQFX9mMEo9WVJ/nmC438eWJDkSgb/XzlvRJ9Dm7fpfo/fBOyf5DLgOcCNDP6BMtX39ETgkrEJFeN8gcG90v/W7quGwf19VwBfb+f5F7yaOGt8/ZgkSfq1dn/c3e097Y8DTvC2l3sXU7IkSRr2YOD0DB47dSfwknmuRxvIkTtJkqSOeM+dJElSRwx3kiRJHTHcSZIkdcRwJ2mzluQf23syL2mP33nsDI6xZ5KnDq0fnOTo2a30t875pCS+nF3Sb3G2rKTNVnvMw9OBvarqjvZy9K1mcKg9Gbxr80yAqlrJ4G0qo/Qk4KfAf4z4PJLuZZwtK2mzleRZwOFV9Yxx7XsD7wbuD/wIOKyqbmivUTof+FNgIYOn/Z8PrAG2Aa4H3tGWl1XVy5J8iMH7PB8N/C7wYuBFwOOA86vqsHbO/Rk8PHZr4Dutrp8muRZYATwD2JLBQ2V/weABsncD6xi8xukrs/unI+neysuykjZnXwB2TfKfSd6f5IntdUj/E3h2Ve0NnAy8bWifBVW1D/BK4Jj2xP03AKdV1Z5Vddr4kzB4fdPjgL9lMKJ3HPAI4JHtku5OwOuBp1TVXsBq4O+G9v9Raz8BeHVVXQv8b+C4dk6DnaRf87KspM1WGxnbm8E7L/+UwSvt3grsAaxqL1DfArhhaLdPtN8XAUumeapPV1UluRT4QVVdCtBeU7YEWAzszuAVZTC4NPy1Sc75rOl/QkmbI8OdpM1aVd0NfAn4UgtfRwGXV9XjJtnljvb7bqb/d+jYPr8aWh5bX9COtaqqnj+L55S0mfKyrKTNVpLfT7J0qGlP4EpgUZtsQZItkzxiPYe6Ddh2I0o5D3h8koe2c94vycNGfE5JnTLcSdqc3R9YkeSKJJcwuDT6BuDZwDuTfBP4BrC+R46cA+zeHqXyvA0toqrWAYcBH211fA14+Hp2+zTwZ+2cf7Kh55TUL2fLSpIkdcSRO0mSpI4Y7iRJkjpiuJMkSeqI4U6SJKkjhjtJkqSOGO4kSZI6YriTJEnqyP8P5XYp8+K9Ud0AAAAASUVORK5CYII=" /></p>
<div class="codehilite"><pre><span></span><code>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../notebooks%20in%20class/sparksql/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Sparksql
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.fd16492e.min.js"></script>
      <script src="../../../assets/javascripts/bundle.7836ba4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: ['instant', 'navigation.expand'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../js/expand.js"></script>
      
    
  </body>
</html>